---
import type { JavaStatusAnswer } from "../interfaces";

import IsOnlineComponent from "../fields/IsOnline.astro";
import HostComponent from "../fields/Host.astro";
import PortComponent from "../fields/Port.astro";
import IconComponent from "../fields/Icon.astro";
import MotdComponent from "../fields/Motd.astro";
import VersionNameComponent from "../fields/VersionName.astro";
import VersionProtocolComponent from "../fields/VersionProtocol.astro";
import PlayersComponent from "../fields/Players.astro";
import CachedComponent from "../fields/Cached.astro";
import AdditionalInfoComponent from "../fields/AdditionalInfo.astro";

export type Props = { status: JavaStatusAnswer };

const { status }: Props = Astro.props;
---

<IsOnlineComponent status={status} />
<HostComponent status={status} />
<PortComponent status={status} />
<IconComponent status={status} />
<MotdComponent status={status} />
<VersionNameComponent status={status} />
<VersionProtocolComponent status={status} />
<PlayersComponent status={status} />
<CachedComponent status={status} />
<AdditionalInfoComponent status={status} />

<!-- Obfuscated formatting code handling -->
<script>
	const obfuscatedCharacters =
		"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789`~!@#$%^&*()-_=+[]\"';:<>,./?";
	const obfuscatedElems = document.querySelector("#minecraft-server-motd")?.querySelectorAll(".obfuscated");

	if (obfuscatedElems !== undefined) {
		const render = () => {
			obfuscatedElems.forEach((elem) => {
				let value = "";

				for (let i = 0, l = elem.innerText.length; i < l; i++) {
					value += obfuscatedCharacters.charAt(Math.floor(Math.random() * obfuscatedCharacters.length));
				}

				elem.innerText = value;
			});
			setTimeout(render, 20);
		};
		render();
	};
</script>
